<!DOCTYPE html>
<html>
	<head>
		<meta charset="utf-8" />
		<title>区块详情</title>
		<link rel="stylesheet" href="css/common.css" />
		<style>
			.tradedetail{
	width: 120px;
	height: 20px;
	background-image: url(img/qukuai.png);
	background-repeat: no-repeat;
	float: left;
}
			.tradedetail2{
	width: 120px;
	height: 20px;
	background-image: url(img/jiaoyijilu.png);
	background-repeat: no-repeat;
	float: left;
}
		</style>
	</head>
	<body class="container">
		<div class="commonhead">
			<div class="commonheadtitle">
				<div class="commonheadlogo"></div>
				<div class="zhuye"></div>
				<div class="heyue"></div>
				<div class="zhongwen"></div>
			</div>
		</div>
		<div class="commonmain">
			<div class="contentmain">
				<div style="height: 50px; width: 100%;">
					<div class="tradedetail"></div>	
				</div>
				<div class="tradeidtable">
					<table width="100%">
						<tr style="line-height: 50px;">
							<td width="5%" class="ywzt">id:</td>
							<td width="30%" id="id" class="boldtr">b7fdsaienvicnancifnvnic7</td>
							<td width="10%"></td>
							<td width="5%" class="ywzt"></td>
							<td width="30%" class="boldtr"></td>
							<td width="5%" class="ywzt"></td>
							<td width="15%" class="rmb"></td>
						</tr>
					</table>
				</div>
				<div class="tradedetailtable">
					<table width="100%">
						<thead>
							<tr class="theadbg">
      							<th style="font-family: 'SimHei'; float: left; padding-top: 12px; padding-left: 10px;">区块信息概览</th>
    							<th></th>
    							<th></th>
    							<th></th>
							</tr>
						</thead>
						<tbody>
							<tr>
								<td width="10%"><h3 style="color: #CCCCCC;">交易个数</h3></td>
								<td width="40%" id="transCount">1002</td>
								<td width="10%"><h3 style="color: #CCCCCC;">大小</h3></td>
								<td width="40%" id="blockSize">301</td>
							</tr>
							<tr class="trbg">
								<td><h3 style="color: #CCCCCC;">交易额</h3></td>
								<td id="amount">10000.0010</td>
								<td><h3 style="color: #CCCCCC;">出块代理</h3></td>
								<td id="signee">123321</td>
							</tr>
							<tr>
								<td><h3 style="color: #CCCCCC;">手续费</h3></td>
								<td id="fee">10.1</td>
								<td><h3 style="color: #CCCCCC;">上一区块的id</h3></td>
								<td id="preId">12543fdgdfg3345345345</td>
							</tr>
							<tr class="trbg">
								<td><h3 style="color: #CCCCCC;">出块奖励</h3></td>
								<td>暂无</td>
								<td></td>
								<td></td>
							</tr>
							<tr class="trbg">
								<td><h3 style="color: #CCCCCC;">出块时间</h3></td>
								<td id="timestamp">2016-10-30T09:32:00</td>
								<td></td>
								<td></td>
							</tr>
						</tbody>
					</table>
				</div>
				<div style="height: 50px; width: 100%; margin-top: 40px;">
					<div class="tradedetail2"></div>	
				</div>
				<div class="tradedetailtable" style="margin-top: 5px; min-height: 500px;">
					<table width="100%">
						<tbody id="transactions">
							<tr class="trbg">
								<td width="40%"><B>id:</B>fdsafdsfdsfdsfdsfdsfdasfdas</td>
								<td width="5%"></td>
								<td width="40%"></td>
								<td width="15%">2016-03-21T05:16:40</td>
							</tr>
							<tr>
								<td><B>From:</B>fdsafdsfdsfdsfdsfdsfdasfdas</td>
								<td><img src="img/arrow.png"  alt="arrow"/></td>
								<td><B>To:</B>fdsafdsfdsfdsfdsfdsfdasfdas</td>
								<td><h3>￥：1000000.11121</h3></td>
							</tr>
							<tr class="trbg">
								<td width="40%"><B>id:</B>fdsafdsfdsfdsfdsfdsfdasfdas</td>
								<td width="5%"></td>
								<td width="40%"></td>
								<td width="15%">2016-03-21T05:16:40</td>
							</tr>
							<tr>
								<td><B>From:</B>fdsafdsfdsfdsfdsfdsfdasfdas</td>
								<td><img src="img/arrow.png"  alt="arrow"/></td>
								<td><B>To:</B>fdsafdsfdsfdsfdsfdsfdasfdas</td>
								<td><h3>￥：1000000.11121</h3></td>
							</tr>
						</tbody>
					</table>
				</div>
			</div>
		</div>
		<div class="commonfoot">
			<div class="commonfoottitle">
				business@thinkyoung.com.cn
			</div>
		</div>
		<script type="text/javascript" src="ui/amaze/js/jquery.min.js"></script>
		<script type="text/javascript">
		var blockNum=getUrlParam("blockNum");
		getBlockByBlockNum(blockNum);
		getTransByBlockNum(blockNum);
		function getBlockByBlockNum(blockNum)
		{
			$.ajax({
			    type: "POST",
			    url: "getBlockByBlockNum.do",
			    data: {blockNum:blockNum},
			    dataType: "json",
			    success: function(data, textStatus)
			    {
		    		$("#id").empty().append(data.id);
		    		$("#transCount").empty().append(data.transCount);
		    		$("#blockSize").empty().append(data.blockSize);
		    		$("#amount").empty().append(data.amount);
		    		$("#signee").empty().append(data.signee);
		    		$("#fee").empty().append(data.fee);
		    		$("#preId").empty().append(data.preId);
		    		$("#timestamp").empty().append(data.timestamp);
			    },
			    error: function(XMLHttpRequest, textStatus, errorThrown)
			    {
			      alert(XMLHttpRequest.status+" 你懂的");
			    }
			});
		}
		
		function getTransByBlockNum(blockNum)
		{
			$.ajax({
			    type: "POST",
			    url: "getTransByBlockNum.do",
			    data: {blockNum:blockNum},
			    dataType: "json",
			    success: function(data, textStatus)
			    {
			    	var transactions = $("#transactions");
			    	transactions.empty();
			    	
			    	for (var o in data)
			    	{
			    		var tr1;
		    			tr1 = $('<tr onclick="hrefTransaction(\''+data[o].trxId+'\')" class="trbg"><td width="40%"><B>id:</B>'+data[o].trxId+'</td><td width="5%"></td><td width="40%"></td><td width="15%">'+data[o].timestamp+'</td></tr>');
		    			var tr2;
		    			tr2 = $('<tr><td><B>From:</B>'+data[o].address1+'</td><td><img src="img/arrow.png"  alt="arrow"/></td><td><B>To:</B>'+data[o].address2+'</td><td><h3>￥：'+data[o].amount+'</h3></td></tr>');
			    		
			    		transactions.append(tr1);
			    		transactions.append(tr2);
			    	}
			    },
			    error: function(XMLHttpRequest, textStatus, errorThrown)
			    {
			      alert(XMLHttpRequest.status+" 你懂的");
			    }
			});
		}
		
		function hrefTransaction(trxId)
		{
			window.location.href="transactionsInfo.html?trxId="+trxId;
		}
		
		function getUrlParam(name) 
		{
		    var reg = new RegExp("(^|&)" + name + "=([^&]*)(&|$)"); //构造一个含有目标参数的正则表达式对象
		    var r = window.location.search.substr(1).match(reg);  //匹配目标参数
		    if (r != null) return unescape(r[2]); return null; //返回参数值
		}
		</script>
	</body>
</html>
